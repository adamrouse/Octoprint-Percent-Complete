<html>
<head>
	<title>Octoprint-Percent-Complete</title>
	<meta charset="UTF-8">
	<meta http-equiv="Refresh" content="180">
	<script>
		var baseurl = "http://[ipaddress]/api";
		function loadJobDetails(){
			var xmlhttp = new XMLHttpRequest();
			xmlhttp.open("GET" , baseurl + "/job", true);
			xmlhttp.setRequestHeader("X-Api-Key", "[api-key]");
			xmlhttp.onreadystatechange = function() {
				if(xmlhttp.readyState === 4 && xmlhttp.status === 200){
				var jobStatus = JSON.parse(xmlhttp.responseText);
				var tbltop = `<table>
								<tr><th>Print Name</th><th>Percentage</th></tr>`;
				//main table content we fill from rest call
				var main = "";
				var compPercent = jobStatus.progress.completion.toFixed(2);
				var trimmedName = jobStatus.job.file.name.substring(0,jobStatus.job.file.name.length - 6);
				main = "<tr><td>"+ trimmedName +"</td><td>"+ compPercent +"%</td></tr>";
				var tblbottom = "</table>";
				var tbl = tbltop + main + tblbottom;
				document.getElementById("percentinfo").innerHTML = tbl;
			}
		};
		xmlhttp.send();
	}
	window.onload = function(){
		loadJobDetails();
	}
	</script>
</head>
<body>
	<div id="percentinfo"> </div>
</body>
</html>